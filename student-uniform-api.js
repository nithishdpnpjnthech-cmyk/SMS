  // ================= STUDENT UNIFORM STATUS API =================\n  app.get(\"/api/student/uniform\", requireStudentAuth(), async (req, res) => {\n    try {\n      const studentId = req.studentId!; // CRITICAL: Use JWT-verified studentId consistently\n      \n      // Get uniform status with fallback to students table\n      const uniformData = await storage.query(`\n        SELECT \n          COALESCE(su.issued, s.uniform_issued, FALSE) as issued,\n          COALESCE(su.issue_date, NULL) as issue_date,\n          COALESCE(su.uniform_size, s.uniform_size, NULL) as uniform_size,\n          s.name as student_name\n        FROM students s\n        LEFT JOIN student_uniforms su ON s.id = su.student_id\n        WHERE s.id = ? AND s.status = 'active'\n      `, [studentId]);\n      \n      if (!uniformData.length) {\n        return res.status(404).json({ error: \"Student not found\" });\n      }\n      \n      const uniform = uniformData[0];\n      \n      res.json({\n        studentId,\n        studentName: uniform.student_name,\n        uniform: {\n          issued: Boolean(uniform.issued),\n          issueDate: uniform.issue_date,\n          size: uniform.uniform_size,\n          status: Boolean(uniform.issued) ? 'Issued' : 'Pending'\n        }\n      });\n    } catch (error) {\n      console.error(\"Student uniform status error:\", error);\n      res.status(500).json({ error: \"Failed to fetch uniform status\" });\n    }\n  });\n\n